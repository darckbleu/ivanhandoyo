<?xml version="1.0" encoding="utf-8" standalone="no"?>
<TfrxReport Version="4.8.11" DotMatrixReport="False" EngineOptions.MaxMemSize="10000000" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="2047" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="40117.5390601389" ReportOptions.Description.Text="" ReportOptions.Name="Report Log" ReportOptions.LastChange="40117.6407237384" ScriptLanguage="PascalScript" ScriptText.Text="procedure PreviewOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  qryLog.Close;&#13;&#10;  // ngecek usernya&#13;&#10;  if (chbEmployee.Checked=false) then&#13;&#10;   begin                   &#13;&#10;    qryLog.Params[0].value := dblcEmployee.KeyValue;&#13;&#10;    txtCriEmployee.Text := 'User dengan Nama ' + dblcEmployee.Text;                                                                                                                                                              &#13;&#10;   end                 &#13;&#10;  else&#13;&#10;   begin                   &#13;&#10;    qryLog.Params[0].value := '%';&#13;&#10;    txtCriEmployee.Text := 'Semua User';&#13;&#10;   end;                   &#13;&#10;      &#13;&#10;  // ngecek action                            &#13;&#10;  if (chbAction.Checked=false) then&#13;&#10;   begin                   &#13;&#10;    qryLog.Params[1].value := inttostr(cbAction.ItemIndex+1);&#13;&#10;    txtCriAction.Text := 'Untuk Aksi ' + cbAction.Text;                                                                                                                              &#13;&#10;   end                 &#13;&#10;  else&#13;&#10;   begin                   &#13;&#10;    qryLog.Params[1].value := '%';&#13;&#10;    txtCriAction.Text := 'Untuk Semua Aksi';  &#13;&#10;   end;  &#13;&#10;     &#13;&#10;  // ngecek table                                       &#13;&#10;  if (chbTableName.Checked=false) then&#13;&#10;   begin                   &#13;&#10;    qryLog.Params[2].value := dblcTableName.KeyValue;&#13;&#10;    txtCriTable.Text := 'Untuk Table ' + dblcTableName.Text;                                                                                                                                         &#13;&#10;   end                   &#13;&#10;  else&#13;&#10;   begin                   &#13;&#10;    qryLog.Params[2].value := '%';&#13;&#10;    txtCriTable.Text := 'Untuk Semua Table';                                                            &#13;&#10;   end;&#13;&#10;     &#13;&#10;  // ngecek keyword                                                      &#13;&#10;  if (ecKeyword.Text&#60;&#62;'') then&#13;&#10;   begin                   &#13;&#10;    qryLog.Params[3].value := '%' + ecKeyword.Text + '%';&#13;&#10;    txtCriKeyword.Text := 'Dengan Keyword &#34;' + ecKeyword.Text + '&#34;';                                                                                               &#13;&#10;   end                   &#13;&#10;  else&#13;&#10;   begin                   &#13;&#10;    qryLog.Params[3].value := '%';&#13;&#10;    txtCriKeyword.Text := 'Tanpa Keyword';        &#13;&#10;   end;                   &#13;&#10;  &#13;&#10;  // ngecek tanggal&#13;&#10;  if (chbDate.Checked=false) then&#13;&#10;   begin&#13;&#10;    qryLog.Params[4].value := deStartDate.Date;&#13;&#10;    qryLog.Params[5].value := EndOfTheDay(deEndDate.Date);&#13;&#10;    txtCriWaktu.Text := 'Untuk Log antara tanggal ' + DateToStr(deStartDate.Date) + ' sampai ' + DateToStr(deEndDate.Date);      &#13;&#10;   end                 &#13;&#10;  else&#13;&#10;   begin                            &#13;&#10;    qryLog.Params[4].value := Now()-10000;                                                     &#13;&#10;    qryLog.Params[5].value := Now();&#13;&#10;    txtCriWaktu.Text := 'Semua Log sampai dengan hari ini';  &#13;&#10;   end;&#13;&#10;  qryLog.Open;                            &#13;&#10;end;&#13;&#10;  &#13;&#10;&#13;&#10;procedure chbEmployeeOnClick(Sender: TfrxComponent);&#13;&#10;Begin&#13;&#10;  if ChbEmployee.Checked=False then&#13;&#10;   dblcEmployee.Enabled := True&#13;&#10;  Else&#13;&#10;   dblcEmployee.Enabled := False;  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure chbDateOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if ChbDate.Checked=False then&#13;&#10;   begin                   &#13;&#10;     deStartDate.Enabled := True;&#13;&#10;     deEndDate.Enabled := True;         &#13;&#10;   end                    &#13;&#10;  Else&#13;&#10;   begin                   &#13;&#10;     deStartDate.Enabled := False;&#13;&#10;     deEndDate.Enabled := False;         &#13;&#10;   end;            &#13;&#10;end;&#13;&#10;&#13;&#10;procedure chbActionOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if ChbAction.Checked=False then&#13;&#10;     cbAction.Enabled := True&#13;&#10;  else&#13;&#10;     cbAction.Enabled := false;                                                            &#13;&#10;end;&#13;&#10;&#13;&#10;procedure chbTableNameOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if chbTableName.Checked=False then&#13;&#10;       dblcTableName.Enabled := True&#13;&#10;  else&#13;&#10;       dblcTableName.Enabled := False;                                                                             &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;  qryLog.Open;&#13;&#10;  qryPrevEmployee.Open;&#13;&#10;  qryPrevTableName.Open;                                                &#13;&#10;end." PropData="044C65667403300103546F700328010844617461736574730101062620446174615365743D227172794C6F672220446174615365744E616D653D227172794C6F67220001063820446174615365743D2271727950726576456D706C6F7965652220446174615365744E616D653D2271727950726576456D706C6F796565220001063A20446174615365743D22717279507265765461626C654E616D652220446174615365744E616D653D22717279507265765461626C654E616D65220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxADOQuery Name="qryLog" UserName="qryLog" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select *&#13;&#10;from TransactionLog&#13;&#10;where Users like :Users        &#13;&#10;and Action like :Action&#13;&#10;and TableName like :TableName&#13;&#10;and Description like :Description                                                                                                                      &#13;&#10;and TransactionDate between :StartDate and :EndDate                                                                                                                       &#13;&#10;order by Users, TransactionDate, Action, TableName                                                                                                                                                                                         " CommandTimeout="30" LockType="ltReadOnly" PropData="05704C656674026C0470546F7002680A506172616D657465727301010621204E616D653D225573657273222044617461547970653D226674537472696E672200010622204E616D653D22416374696F6E222044617461547970653D226674537472696E672200010625204E616D653D225461626C654E616D65222044617461547970653D226674537472696E672200010627204E616D653D224465736372697074696F6E222044617461547970653D226674537472696E672200010627204E616D653D22537461727444617465222044617461547970653D2266744461746554696D652200010625204E616D653D22456E6444617465222044617461547970653D2266744461746554696D65220000"/>
    <TfrxADOQuery Name="qryPrevEmployee" UserName="qryPrevEmployee" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select EmployeeId, EmployeeName&#13;&#10;from Employee&#13;&#10;order by EmployeeName                                                                " CommandTimeout="30" LockType="ltReadOnly" PropData="05704C656674026C0470546F7003A0000A506172616D65746572730100"/>
    <TfrxADOQuery Name="qryPrevTableName" UserName="qryPrevTableName" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select Name&#13;&#10;from sysobjects&#13;&#10;where xtype='U'&#13;&#10;order By Name                              " CommandTimeout="30" LockType="ltReadOnly" PropData="05704C656674026C0470546F7003D4000A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" PaperWidth="215.9" PaperHeight="279.4" PaperSize="1" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxColumnHeader Name="ColumnHeader1" Height="37.7953" Left="0" Top="224" Width="740.409927">
      <TfrxMemoView Name="Memo2" Left="0" Top="0" Width="109.60637" Height="37.7953" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="User"/>
      <TfrxMemoView Name="Memo3" Left="109.3859" Top="0" Width="120.94496" Height="37.7953" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Waktu"/>
      <TfrxMemoView Name="Memo4" Left="230.33086" Top="0" Width="60.47248" Height="37.7953" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Action"/>
      <TfrxMemoView Name="Memo5" Left="291.48052" Top="0" Width="132.28355" Height="37.7953" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Tabel"/>
      <TfrxMemoView Name="Memo6" Left="424.52783" Top="0" Width="317.48052" Height="37.7953" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Keterangan"/>
    </TfrxColumnHeader>
    <TfrxMasterData Name="MasterData1" Height="26.45671" Left="0" Top="280" Width="740.409927" ColumnWidth="0" ColumnGap="0" DataSet="qryLog" DataSetName="qryLog" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo7" Left="0" Top="0" Width="109.60637" Height="26.45671" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[qryLog.&#34;Users&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="109.60637" Top="0" Width="120.94496" Height="26.45671" ShowHint="False" StretchMode="smMaxHeight" DisplayFormat.FormatStr="dd-mm-yyyy HH:mm" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[qryLog.&#34;TransactionDate&#34;]"/>
      <TfrxMemoView Name="txtAction" Left="230.33086" Top="0" Width="60.47248" Height="26.45671" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[IIF(&#60;qryLog.&#34;Action&#34;&#62;='1','Insert',IIF(&#60;qryLog.&#34;Action&#34;&#62;='2','Update','Delete'))]"/>
      <TfrxMemoView Name="Memo9" Left="291.70099" Top="0" Width="132.28355" Height="26.45671" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[qryLog.&#34;TableName&#34;]"/>
      <TfrxMemoView Name="Memo10" Left="424.08689" Top="0" Width="317.48052" Height="26.45671" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[qryLog.&#34;Description&#34;]"/>
    </TfrxMasterData>
    <TfrxReportTitle Name="ReportTitle1" Height="188.9765" Left="0" Top="16" Width="740.409927">
      <TfrxMemoView Name="Memo1" Left="294.80334" Top="15.11812" Width="158.74026" Height="34.01577" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-27" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Log Report"/>
      <TfrxMemoView Name="Memo12" Left="3.77953" Top="68.03154" Width="56.69295" Height="18.89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Kriteria: "/>
      <TfrxMemoView Name="txtCriEmployee" Left="64.25201" Top="68.03154" Width="260.78757" Height="18.89765" ShowHint="False" StretchMode="smActualHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="txtCriWaktu" Left="64.25201" Top="90.70872" Width="408.18924" Height="18.07601304" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="txtCriAction" Left="64.25201" Top="112.39993565" Width="260.78757" Height="18.07601304" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="txtCriTable" Left="64.25201" Top="134.0911513" Width="260.78757" Height="18.07601304" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="txtCriKeyword" Left="64.25201" Top="155.78236696" Width="260.78757" Height="18.07601304" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" VAlign="vaCenter" Text=""/>
    </TfrxReportTitle>
    <TfrxPageFooter Name="PageFooter1" Height="86.92919" Left="0" Top="328" Width="740.409927">
      <TfrxMemoView Name="Memo11" Left="-3.77953" Top="56.69295" Width="94.48825" Height="18.89765" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Page - [Page#]"/>
    </TfrxPageFooter>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Height="238" ClientHeight="209" Left="339" Top="112" Width="541" ClientWidth="535">
    <TfrxLabelControl Name="Label1" Left="18" Top="12" Width="31" Height="16" ShowHint="True" Caption="User:" Color="-16777201"/>
    <TfrxLabelControl Name="Label2" Left="18" Top="36" Width="91" Height="16" ShowHint="True" Caption="Tanggal Antara:" Color="-16777201"/>
    <TfrxLabelControl Name="Label3" Left="18" Top="60" Width="41" Height="16" ShowHint="True" Caption="Action:" Color="-16777201"/>
    <TfrxLabelControl Name="Label4" Left="18" Top="108" Width="120" Height="16" ShowHint="True" Caption="Keyword Keterangan" Color="-16777201"/>
    <TfrxLabelControl Name="Label5" Left="18" Top="84" Width="31" Height="16" ShowHint="True" Caption="Table" Color="-16777201"/>
    <TfrxButtonControl Name="Preview" Left="168" Top="152" Width="75" Height="25" ShowHint="True" Caption="Preview" ModalResult="1" OnClick="PreviewOnClick"/>
    <TfrxDBLookupComboBox Name="dblcEmployee" Left="144" Top="8" Width="145" Height="21" Enabled="False" ShowHint="True" ListField="EmployeeName" DataSet="qryPrevEmployee" DataSetName="qryPrevEmployee" KeyField="EmployeeId"/>
    <TfrxDateEditControl Name="deStartDate" Left="144" Top="32" Width="93" Height="21" Enabled="False" ShowHint="True" Color="-16777211" Date="40117" Time="40117"/>
    <TfrxLabelControl Name="Label6" Left="244" Top="32" Width="4" Height="16" ShowHint="True" Caption="-" Color="-16777201"/>
    <TfrxDateEditControl Name="deEndDate" Left="252" Top="32" Width="97" Height="21" Enabled="False" ShowHint="True" Color="-16777211" Date="40117" Time="40117"/>
    <TfrxComboBoxControl Name="cbAction" Left="144" Top="56" Width="93" Height="21" Enabled="False" ShowHint="True" Color="-16777211" Items.Text="Insert&#13;&#10;Update&#13;&#10;Delete" ItemIndex="-1"/>
    <TfrxDBLookupComboBox Name="dblcTableName" Left="144" Top="80" Width="145" Height="21" Enabled="False" ShowHint="True" ListField="Name" DataSet="qryPrevTableName" DataSetName="qryPrevTableName" KeyField="Name"/>
    <TfrxEditControl Name="ecKeyword" Left="144" Top="104" Width="301" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/>
    <TfrxCheckBoxControl Name="chbEmployee" Left="291" Top="10" Width="61" Height="17" ShowHint="True" Caption="Semua" Checked="True" State="cbChecked" Color="-16777201" OnClick="chbEmployeeOnClick"/>
    <TfrxCheckBoxControl Name="chbDate" Left="356" Top="36" Width="61" Height="17" ShowHint="True" Caption="Semua" Checked="True" State="cbChecked" Color="-16777201" OnClick="chbDateOnClick"/>
    <TfrxCheckBoxControl Name="chbAction" Left="244" Top="60" Width="61" Height="17" ShowHint="True" Caption="Semua" Checked="True" State="cbChecked" Color="-16777201" OnClick="chbActionOnClick"/>
    <TfrxCheckBoxControl Name="chbTableName" Left="296" Top="84" Width="65" Height="17" ShowHint="True" Caption="Semua" Checked="True" State="cbChecked" Color="-16777201" OnClick="chbTableNameOnClick"/>
  </TfrxDialogPage>
</TfrxReport>
